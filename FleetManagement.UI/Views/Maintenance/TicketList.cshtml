@using FleetManagement.UI.Models.Dto

@model List<MaintenanceTicket>

@* <div class="container mt-4">
    <h2>All Maintenance Tickets</h2>

    <div class="d-flex justify-content-between mb-3">
        <a asp-action="AddTicket" class="btn btn-primary">
            <i class="ri-add-line"></i> Add New Ticket
        </a>
    </div>

    <table class="table table-bordered">
        <thead>
            <tr>
                <th>Ticket Number</th>
                <th>Items</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var ticket in Model)
            {
                <tr>
                    <td>@ticket.TicketNumber</td>
                    <td>
                        @foreach (var item in ticket.Items)
                        {
                            <p>@item.Part - @item.Quantity pcs</p>
                        }
                    </td>
                    <td>
                        @if (ticket.IsApproved)
                        {
                            <span class="badge bg-success">Approved</span>
                        }
                        else if (ticket.IsSubmitted)
                        {
                            <span class="badge bg-warning">Pending Approval</span>
                        }
                        else
                        {
                            <span class="badge bg-primary">Active (Open)</span>
                        }
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>
 *@


 <div class="container mt-4">
    <div class="col-lg-7 col-md-12">
        <div class="card ">
            <div class="card-body">
                <div class="d-md-flex align-items-center">
                    <div>
                        <h4 class="card-title">All Maintenance Tickets</h4>
                        <p class="card-subtitle">Total Number of tickets: <strong>@ViewBag.TotalTickets</strong></p>
                    </div>
                </div>
                <div class="mt-3">
                    <a asp-action="AddTicket" class="btn btn-primary">
                        <i class="ri-add-line"></i> Add New Ticket
                    </a>
                </div>
                <div class="table-responsive">
                    <table class="table stylish-table mt-4 no-wrap v-middle mb-0">
                        <thead>
                            <tr>
                                <th class="border-0">Product</th>
                                <th class="border-0">Items</th>
                                <th class="border-0">Total Quantity</th>
                                <th class="border-0">Total Cost</th>
                                <th class="border-0">Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var ticket in Model)
                            {
                                <tr>
                                    <td>
                                        @if (ticket.IsApproved)
                                        {
                                            <span class="round text-white hstack justify-content-center text-center rounded-circle text-bg-success">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-check-circle">
                                                    <path d="M9 12l2 2 4-4"></path>
                                                    <circle cx="12" cy="12" r="10"></circle>
                                                </svg>
                                            </span>
                                        }
                                        else if (ticket.IsRejected)
                                        {
                                            <span class="round text-white hstack justify-content-center text-center rounded-circle text-bg-danger">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x-circle">
                                                    <circle cx="12" cy="12" r="10"></circle>
                                                    <line x1="15" y1="9" x2="9" y2="15"></line>
                                                    <line x1="9" y1="9" x2="15" y2="15"></line>
                                                </svg>
                                            </span>
                                        }
                                        else if (ticket.IsSubmitted)
                                        {
                                            <span class="round text-white hstack justify-content-center text-center rounded-circle text-bg-warning">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
                                                    <circle cx="12" cy="12" r="10"></circle>
                                                    <polyline points="12 6 12 12 16 14"></polyline>
                                                </svg>
                                            </span>
                                        }
                                    </td>

                                    <td>
                                        <h6 class="mb-0">
                                            <a href="javascript:void(0)" class="link">
                                                @foreach (var item in ticket.Items)
                                                {
                                                    <p>@item.Part - @item.Quantity pcs</p>
                                                }
                                            </a>
                                        </h6>
                                        <small class="text-muted">
                                            Ticket Number : @ticket.TicketNumber
                                        </small>
                                    </td>

                                    <td>
                                        <h5>@ticket.TotalQuantity</h5>
                                    </td>

                                    <td>
                                        <h5>₦@ticket.TotalCost.ToString("N2")</h5>
                                    </td>

                                    <td>
                                        @if (ticket.IsApproved)
                                        {
                                            <span class="badge bg-success">Approved</span>
                                        }
                                        else if (ticket.IsRejected)
                                        {
                                            <span class="badge bg-danger">Request Rejected</span>
                                        }
                                        else if (ticket.IsSubmitted)
                                        {
                                            <span class="badge bg-warning">Pending Approval</span>
                                        }
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>

            </div>
        </div>
    </div>

 </div>




